{% extends "base/base.html" %}

{% block content %}

<div class="container">
  <h1>Packages</h1>
  {% if error %}
  <div class='error'>ERROR : {{ error }}</div>
  {% endif %}

  {% if sub_list|length == 0 %}
    <p>There is no submitted package</p>

  {% else %}
    <div class="input-group"> <span class="input-group-addon">Search</span>
      <input id="filter_section" type="text" class="form-control" placeholder="Type here...">
    </div>
    <div class="searchable">
      {% for item in sub_list %}
        <section class="package">
          <h2>{{ item.type }} - {{ item.name }} - <span class="version">version {{ item.version }}</span><img class="build" src='{{ item.url_build_status }}'/></h2>
          <p class="author">
            By {{ item.author }} {% if g.core_team %} <span class="admin">{{ item.author_email }} </span> {% endif %}
          </p>
          <p class="description">
            {{ item.description }}
          </p>
          <ul class="tags">
            <span>Tags : </span>
            {% for tag in item.tags %}
              <li>
                {{ tag }}
              </li>
            {% endfor %}
          </ul>

          <div class="details">
          <span>More details</span>
          <ul>
            {% if g.core_team %}
              <li class="admin">Submitted by : {{ item.submitter }} on {{ item.submission_date }}</li>
            {% endif %}
          </ul>

          <div>
            <a class="install" href="#">Install</a>
            <a class="download" href="{{ item.url_package }}">Download the package sources</a>
            {% if g.core_team %}
              <a href="{{ url_for("validate_package") }}?type={{ item.type }}&name={{ item.name }}&version={{ item.version }}">Validate the package</a>
              <a href="#">TODO : Refuse the package</a>
            {% endif %}
          </div>
          <pre class="install_instructions">
             dmg_package --install {{ item.url_package }}
          </pre>
        </section>
      {% endfor %}
    </div>
  {% endif %}

</div>
{% endblock %}

